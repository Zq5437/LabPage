# ğŸš€ ç½‘ç«™ä¸Šçº¿æ£€æŸ¥æ¸…å•

## âœ… éƒ¨ç½²å‰æ£€æŸ¥

### 1. ç¯å¢ƒå‡†å¤‡
- [ ] Node.js å·²å®‰è£… (16.0+)
- [ ] MySQL å·²å®‰è£…å¹¶è¿è¡Œ
- [ ] Nginx å·²å®‰è£…
- [ ] Cpolar å·²å®‰è£…å¹¶æœ‰è´¦å·
- [ ] Apache å·²åœæ­¢ï¼ˆé¿å…ç«¯å£å†²çªï¼‰

**æ£€æŸ¥å‘½ä»¤ï¼š**
```bash
node -v          # åº”æ˜¾ç¤º v16.0.0 æˆ–æ›´é«˜
mysql --version  # åº”æ˜¾ç¤º 8.0 æˆ–æ›´é«˜
nginx -v         # åº”æ˜¾ç¤ºç‰ˆæœ¬å·
cpolar version   # åº”æ˜¾ç¤ºç‰ˆæœ¬å·
sudo lsof -i :80 # ç¡®ä¿80ç«¯å£æœªè¢«å ç”¨
```

### 2. æ•°æ®åº“é…ç½®
- [ ] MySQL æœåŠ¡å·²å¯åŠ¨
- [ ] æ•°æ®åº“ `lab_website` å·²åˆ›å»º
- [ ] æ•°æ®åº“è¡¨ç»“æ„å·²å¯¼å…¥
- [ ] é»˜è®¤ç®¡ç†å‘˜è´¦å·å·²åˆ›å»º

**æ‰§è¡Œå‘½ä»¤ï¼š**
```bash
# å¯åŠ¨ MySQL
brew services start mysql

# å¯¼å…¥æ•°æ®åº“
mysql -u root -p < database/schema.sql

# éªŒè¯æ•°æ®åº“
mysql -u root -p -e "USE lab_website; SHOW TABLES;"
```

### 3. åç«¯é…ç½®
- [ ] `backend/.env` æ–‡ä»¶å·²åˆ›å»º
- [ ] æ•°æ®åº“å¯†ç å·²æ­£ç¡®é…ç½®
- [ ] JWT_SECRET å·²è®¾ç½®ä¸ºéšæœºå­—ç¬¦ä¸²
- [ ] uploads ç›®å½•æœ‰å†™å…¥æƒé™

**æ£€æŸ¥ backend/.envï¼š**
```bash
cd backend
cat .env  # ç¡®è®¤é…ç½®æ­£ç¡®

# å¦‚æœæ²¡æœ‰ .env æ–‡ä»¶ï¼Œä»ç¤ºä¾‹å¤åˆ¶
cp config.example.js config.js
```

### 4. å‰ç«¯æ„å»º
- [ ] å‰ç«¯ä¾èµ–å·²å®‰è£…
- [ ] å‰ç«¯å·²æˆåŠŸæ„å»º
- [ ] `frontend/dist` ç›®å½•å­˜åœ¨ä¸”æœ‰æ–‡ä»¶

**æ„å»ºå‘½ä»¤ï¼š**
```bash
cd frontend
npm install
npm run build
ls -la dist  # ç¡®è®¤æœ‰ index.html ç­‰æ–‡ä»¶
```

### 5. ç®¡ç†åå°æ„å»º
- [ ] ç®¡ç†åå°ä¾èµ–å·²å®‰è£…
- [ ] ç®¡ç†åå°å·²æˆåŠŸæ„å»º
- [ ] `admin/dist` ç›®å½•å­˜åœ¨ä¸”æœ‰æ–‡ä»¶
- [ ] vite.config.js ä¸­ base è®¾ç½®ä¸º '/admin/'

**æ„å»ºå‘½ä»¤ï¼š**
```bash
cd admin
npm install
npm run build
ls -la dist  # ç¡®è®¤æœ‰ index.html ç­‰æ–‡ä»¶
```

## ğŸ”§ Nginx é…ç½®æ£€æŸ¥

### é…ç½®æ–‡ä»¶æ£€æŸ¥
- [ ] Nginx é…ç½®æ–‡ä»¶å·²æ­£ç¡®ä¿®æ”¹
- [ ] ç›‘å¬ç«¯å£ä¸º 80
- [ ] å‰ç«¯è·¯å¾„æŒ‡å‘æ­£ç¡®
- [ ] ç®¡ç†åå°è·¯å¾„æŒ‡å‘æ­£ç¡®
- [ ] API åå‘ä»£ç†é…ç½®æ­£ç¡®
- [ ] uploads ç›®å½•é…ç½®æ­£ç¡®

**æµ‹è¯•é…ç½®ï¼š**
```bash
# æµ‹è¯• nginx é…ç½®
sudo nginx -t

# åº”æ˜¾ç¤ºï¼š
# nginx: the configuration file /opt/homebrew/etc/nginx/nginx.conf syntax is ok
# nginx: configuration file /opt/homebrew/etc/nginx/nginx.conf test is successful
```

### è·¯å¾„ç¡®è®¤
æ£€æŸ¥ nginx.conf ä¸­çš„è·¯å¾„æ˜¯å¦æ­£ç¡®ï¼š
```
å‰ç«¯: /Users/zhangqi/Desktop/å®éªŒå®¤å»ºç«™/2æ¡†æ¶æµ‹è¯•/LabPage/frontend/dist
ç®¡ç†: /Users/zhangqi/Desktop/å®éªŒå®¤å»ºç«™/2æ¡†æ¶æµ‹è¯•/LabPage/admin/dist
ä¸Šä¼ : /Users/zhangqi/Desktop/å®éªŒå®¤å»ºç«™/2æ¡†æ¶æµ‹è¯•/LabPage/backend/uploads/
```

## ğŸ¯ éƒ¨ç½²æ­¥éª¤

### è‡ªåŠ¨éƒ¨ç½²ï¼ˆæ¨èï¼‰
```bash
# è¿è¡Œéƒ¨ç½²è„šæœ¬
./deploy.sh
```

### æ‰‹åŠ¨éƒ¨ç½²
```bash
# 1. æ„å»ºå‰ç«¯
cd frontend && npm install && npm run build

# 2. æ„å»ºç®¡ç†åå°
cd ../admin && npm install && npm run build

# 3. å®‰è£…åç«¯ä¾èµ–
cd ../backend && npm install

# 4. å¯åŠ¨åç«¯ï¼ˆæ¨èä½¿ç”¨ PM2ï¼‰
npm install -g pm2
pm2 start server.js --name LabPage_backend
pm2 save

# 5. å¯åŠ¨ Nginx
sudo nginx -t
sudo brew services restart nginx
```

## ğŸŒ æœåŠ¡éªŒè¯

### 1. åç«¯æœåŠ¡æ£€æŸ¥
- [ ] åç«¯è¿è¡Œåœ¨ 5080 ç«¯å£
- [ ] API å¯ä»¥è®¿é—®

**æ£€æŸ¥å‘½ä»¤ï¼š**
```bash
# æ£€æŸ¥ç«¯å£
lsof -i :5080

# æµ‹è¯• API
curl http://localhost:5080/public/lab-info

# æŸ¥çœ‹åç«¯æ—¥å¿—ï¼ˆå¦‚æœä½¿ç”¨ PM2ï¼‰
pm2 logs LabPage_backend
```

### 2. Nginx æœåŠ¡æ£€æŸ¥
- [ ] Nginx è¿è¡Œåœ¨ 80 ç«¯å£
- [ ] Nginx æœåŠ¡çŠ¶æ€æ­£å¸¸

**æ£€æŸ¥å‘½ä»¤ï¼š**
```bash
# æ£€æŸ¥ Nginx çŠ¶æ€
sudo brew services list | grep nginx

# æ£€æŸ¥ç«¯å£
sudo lsof -i :80

# æŸ¥çœ‹ Nginx æ—¥å¿—
tail -f /opt/homebrew/var/log/nginx/lab_website.access.log
tail -f /opt/homebrew/var/log/nginx/lab_website.error.log
```

### 3. ç½‘ç«™è®¿é—®æµ‹è¯•
- [ ] å‰ç«¯é¦–é¡µå¯è®¿é—®ï¼šhttp://localhost
- [ ] ç®¡ç†åå°å¯è®¿é—®ï¼šhttp://localhost/admin
- [ ] API å¯è®¿é—®ï¼šhttp://localhost/api/public/lab-info
- [ ] é™æ€èµ„æºåŠ è½½æ­£å¸¸
- [ ] å›¾ç‰‡ä¸Šä¼ åŠŸèƒ½æ­£å¸¸

**æµè§ˆå™¨æµ‹è¯•ï¼š**
```bash
# æ‰“å¼€æµè§ˆå™¨æµ‹è¯•
open http://localhost
open http://localhost/admin
```

## ğŸ”Œ Cpolar ç©¿é€é…ç½®

### 1. Cpolar åŸºç¡€é…ç½®
- [ ] Cpolar å·²å®‰è£…
- [ ] Authtoken å·²é…ç½®
- [ ] å›ºå®šåŸŸåå·²ç”³è¯·ï¼ˆå¯é€‰ï¼‰

**é…ç½®å‘½ä»¤ï¼š**
```bash
# è®¾ç½® authtoken
cpolar authtoken ä½ çš„token

# æµ‹è¯•ç©¿é€
cpolar http 80
```

### 2. å›ºå®šåŸŸåé…ç½®ï¼ˆæ¨èï¼‰
- [ ] é…ç½®æ–‡ä»¶å·²åˆ›å»º
- [ ] éš§é“é…ç½®å·²æ·»åŠ 
- [ ] å›ºå®šåŸŸåå·²è®¾ç½®

**é…ç½®æ–‡ä»¶ä½ç½®ï¼š**
```bash
vim ~/.cpolar/cpolar.yml
```

### 3. å…¬ç½‘è®¿é—®æµ‹è¯•
- [ ] Cpolar éš§é“å·²å¯åŠ¨
- [ ] å¯ä»¥é€šè¿‡å…¬ç½‘åœ°å€è®¿é—®
- [ ] HTTPS è®¿é—®æ­£å¸¸
- [ ] ç®¡ç†åå°å¯é€šè¿‡å…¬ç½‘è®¿é—®

## ğŸ”’ å®‰å…¨æ£€æŸ¥

### 1. è´¦å·å®‰å…¨
- [ ] å·²ä¿®æ”¹é»˜è®¤ç®¡ç†å‘˜å¯†ç 
- [ ] JWT_SECRET ä½¿ç”¨äº†å¼ºå¯†ç 
- [ ] æ•°æ®åº“å¯†ç è¶³å¤Ÿå¤æ‚

### 2. æ–‡ä»¶æƒé™
- [ ] uploads ç›®å½•æƒé™æ­£ç¡®
- [ ] é…ç½®æ–‡ä»¶æƒé™å®‰å…¨ï¼ˆ.env ä¸èƒ½è¢«å…¬ç½‘è®¿é—®ï¼‰

### 3. é˜²ç«å¢™è®¾ç½®
- [ ] åªå¼€æ”¾å¿…è¦ç«¯å£ï¼ˆ80, 443ï¼‰
- [ ] 5080 ç«¯å£ä¸å¯¹å¤–æš´éœ²

## ğŸ“Š åŠŸèƒ½æµ‹è¯•

### å‰ç«¯åŠŸèƒ½
- [ ] é¦–é¡µæ­£å¸¸æ˜¾ç¤º
- [ ] æ–°é—»åˆ—è¡¨åŠ è½½æ­£å¸¸
- [ ] æˆå‘˜é¡µé¢æ˜¾ç¤ºæ­£å¸¸
- [ ] é¡¹ç›®é¡µé¢æ˜¾ç¤ºæ­£å¸¸
- [ ] è®ºæ–‡é¡µé¢æ˜¾ç¤ºæ­£å¸¸
- [ ] è”ç³»è¡¨å•å¯ä»¥æäº¤

### ç®¡ç†åå°åŠŸèƒ½
- [ ] ç™»å½•åŠŸèƒ½æ­£å¸¸
- [ ] ä»ªè¡¨ç›˜æ•°æ®æ˜¾ç¤ºæ­£å¸¸
- [ ] å¯ä»¥æ·»åŠ /ç¼–è¾‘æ–°é—»
- [ ] å¯ä»¥æ·»åŠ /ç¼–è¾‘æˆå‘˜
- [ ] å¯ä»¥ä¸Šä¼ å›¾ç‰‡
- [ ] å›¾ç‰‡æ˜¾ç¤ºæ­£å¸¸

## ğŸ“ æ€§èƒ½ä¼˜åŒ–ï¼ˆå¯é€‰ï¼‰

- [ ] å¯ç”¨ Nginx Gzip å‹ç¼©
- [ ] é…ç½®é™æ€èµ„æºç¼“å­˜
- [ ] ä½¿ç”¨ PM2 é›†ç¾¤æ¨¡å¼
- [ ] é…ç½®æ•°æ®åº“ç´¢å¼•
- [ ] è®¾ç½®æ—¥å¿—è½®è½¬

**Gzip é…ç½®ï¼š**
åœ¨ nginx.conf ä¸­å–æ¶ˆæ³¨é‡Šï¼š
```nginx
gzip on;
gzip_types text/plain text/css application/json application/javascript;
```

## ğŸ”„ å¤‡ä»½é…ç½®

### å®šæœŸå¤‡ä»½
- [ ] è®¾ç½®æ•°æ®åº“è‡ªåŠ¨å¤‡ä»½
- [ ] å¤‡ä»½ uploads ç›®å½•
- [ ] å¤‡ä»½é…ç½®æ–‡ä»¶

**å¤‡ä»½è„šæœ¬ç¤ºä¾‹ï¼š**
```bash
# æ•°æ®åº“å¤‡ä»½
mysqldump -u root -p lab_website > backup_$(date +%Y%m%d).sql

# æ–‡ä»¶å¤‡ä»½
tar -czf uploads_backup_$(date +%Y%m%d).tar.gz backend/uploads/
```

## ğŸ“ åº”æ€¥è”ç³»

### å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥

**é‡å¯æ‰€æœ‰æœåŠ¡ï¼š**
```bash
pm2 restart LabPage_backend
sudo brew services restart nginx
```

**æŸ¥çœ‹æ—¥å¿—ï¼š**
```bash
pm2 logs LabPage_backend
tail -f /opt/homebrew/var/log/nginx/lab_website.error.log
```

**åœæ­¢æ‰€æœ‰æœåŠ¡ï¼š**
```bash
pm2 stop LabPage_backend
sudo brew services stop nginx
```

## âœ¨ å®Œæˆç¡®è®¤

å…¨éƒ¨æ£€æŸ¥å®Œæˆåï¼Œç¡®è®¤ä»¥ä¸‹å†…å®¹ï¼š

âœ… ç½‘ç«™å¯ä»¥é€šè¿‡ localhost è®¿é—®  
âœ… ç½‘ç«™å¯ä»¥é€šè¿‡ cpolar å…¬ç½‘åœ°å€è®¿é—®  
âœ… ç®¡ç†åå°å¯ä»¥ç™»å½•  
âœ… å¯ä»¥æ­£å¸¸æ·»åŠ /ç¼–è¾‘å†…å®¹  
âœ… å›¾ç‰‡ä¸Šä¼ å’Œæ˜¾ç¤ºæ­£å¸¸  
âœ… æ‰€æœ‰é¡µé¢éƒ½èƒ½æ­£å¸¸è®¿é—®  
âœ… ç§»åŠ¨ç«¯è®¿é—®æ­£å¸¸  

---

**æ­å–œï¼ğŸ‰ ä½ çš„å®éªŒå®¤ç½‘ç«™å·²æˆåŠŸä¸Šçº¿ï¼**

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ï¼š
- `éƒ¨ç½²æŒ‡å—.md` - è¯¦ç»†éƒ¨ç½²è¯´æ˜
- `cpolaré…ç½®è¯´æ˜.md` - Cpolar ä½¿ç”¨æŒ‡å—
- `/opt/homebrew/var/log/nginx/` - Nginx æ—¥å¿—
- `pm2 logs` - åç«¯æ—¥å¿—

